# 概率推理

> 原文:[https://www.tutorialandexample.com/probabilistic-reasoning/](https://www.tutorialandexample.com/probabilistic-reasoning/)

**概率推理**

概率推理是根据概率论的原理，研究如何建立能够在不确定的情况下进行推理的网络模型。

 ****贝叶斯网络**

贝叶斯网络是一种用来表示变量之间依赖关系的数据结构。它用于表示任何完整的联合分布。贝叶斯网络又被称为**信念网络、概率网络、因果网络、**和**知识图谱**。

网络的表示是通过有向图来完成的，其中每个节点都用定量的概率信息来标注。该图是有向无环图。因此，它没有有向循环。

**贝叶斯网络基于以下规范:**

*   每个节点对应一个随机变量，可以是离散的，也可以是连续的。箭头或一组链接用于连接一对节点。**例如，**如果有一个从节点 G 到节点 S 的箭头，这意味着 G 是 S 的父节点，记住，该图不包含有向循环，因为它是一个非循环图。
*   每个节点 A <sub>i</sub> 都有一个条件概率分布 P(A <sub>i</sub> |父节点(A <sub>i</sub> ))，它量化了父节点对节点的影响。
*   网络的节点集和拓扑指定了在域中保持的条件独立性关系。当与拓扑结合时，条件独立性隐含地指定所有变量的完全联合分布。

**贝叶斯网络的例子**

假设 Pinku 安装了一个新的防盗报警器。检测入室盗窃是可靠的，但它也对小地震做出反应。想想 Pinku 有两个邻居，Akshat 和 Aakash，他们答应 Pinku 在听到警报时在工作时给他打电话。当听到任何警报时，Akshat 几乎总是呼叫。但有时他会被电话铃声和闹钟弄糊涂，然后再打电话。Aakash 喜欢大声的音乐，经常完全错过闹钟。在下图中，我们可以确定谁打过电话，谁没有打过电话。估计入室盗窃的可能性。

<figure class="aligncenter">![Example of Bayesian Network](../Images/2a7f91166fe3792322ff4d8e73c48952.png)</figure>

**解决方案:**从上图可以清楚地看出，地震和入室盗窃直接影响了报警器响起的概率。但不为人知的是，Akshat 和 Aakash 的通话仅仅依靠警报。因此，网络图代表了这样一种假设，即他们没有直接感受到盗窃，没有注意到小地震，也没有不打电话就商量。条件概率表(CPT)显示了条件分布。CPT 中的每一行都有一个条件情况下每个节点值的条件概率(父节点值的可能组合)。每行的总和应为 1。在布尔值的情况下，真值的概率是 p，假值的概率将是(1-p)。

可以看出，没有节点对应于 Aakash 当前正在听音乐或电话铃声的事实，并且混淆了 Pinku。所有这些因素在从警报到 AkshatCalls 和 AakashCalls 的链接的不确定性中得到总结。这种概率概括了一组潜在的无限条件，在这些条件下，警报可能无法关闭，或者邻居可能无法打电话报告。

因此，这表明一个小的代理人可以大致处理大的世界。

为了计算入室盗窃的概率，

<figure class="wp-block-image">![Baye’s Rule](../Images/17b21a5e7fa5e9801833fcd753ad9f55.png)</figure>

给定，P(B)=0.001，P(A)=0.05(会取假概率)。我们需要计算 P(A|B)。

P(A | B)= P(B)x P(E)x 0.95+P(B)x P(~ E)x 0.94…[P(B)= 1]

=1 x 0.002 x 0.95 + 1 x (1-0.002) x 0.94

=0.94

因此，入室盗窃的概率为，P(B|A)=0.94 x 0.001

Zero point zero five

                                                                  = 0.016

**贝叶斯网络的语义**

为了理解贝叶斯网络的语义，有以下两种方式用于表示网络:

1.  联合概率分布
2.  条件独立语句集合的一种编码

**联合概率分布**

它用于理解网络是如何创建或构建的。这取决于网络及其语义来指定所有变量的联合分布。用于联合分布概率的符号可以表示为:

**P(x <sub>1</sub> ，…..，x <sub>n</sub> ) =**

 **其中 parents(Xi)表示出现在 x <sub>1</sub> ，x <sub>2</sub> ，…x <sub>n</sub> 中的 Parents(Xi)的值。因此，每个条目都由贝叶斯网络中条件概率表的适当元素的乘积来表示。

证明了条件概率真的与

p(Xi |父母(Xi))，暗示了共同分配。因此，我们可以将上面的等式改写为:

**P(x <sub>1</sub> ，…..，x <sub>n</sub> ) =**

 ****让我们在上面解释的贝叶斯网络** **:** 的例子上应用联合概率分布

**问题:**计算警报已经响起，但既没有发生地震，也没有发生入室盗窃，Akshat 和 Aakash 都给 Pinku 打了电话的概率。

**解决方案:**鉴于此，两个邻居都打了电话。

因此，可以通过将来自联合分布的条目相乘来计算联合概率分布，即，

□是否？∞∞在以下情况下

= 0.90 x 0.70 x 0.001 x 0.999 x 0.998

= 0.000628.

**构建贝叶斯网络所采取的步骤，其给出了联合概率分布的良好结果:**

*   通过应用乘积规则，根据条件概率重写联合分布中的所有条目，如下所示:

P(x <sub>1</sub> …..x<sub>n</sub>)= P(x<sub>n</sub>| x<sub>n-1</sub>……，x <sub>1</sub> )。P(x <sub>n-1</sub> ……..，x <sub>1</sub> )。

*   重复这个过程，把每个合取概率减少到一个有条件的合取概率。因此，我们得到，

**P(x <sub>1</sub> ……，x<sub>n</sub>= p(x<sub>n</sub>| x<sub>n-1</sub>……，x <sub>1</sub> 。******(******<sub>？</sub>****<sub>【1】</sub>****|****<sub>【2】</sub>**、**、……-什么、x****<sub>【1】</sub>****……-什么******(****|****************

**=****P(x<sub>I</sub>| x<sub>I-1</sub>…..，x <sub>1</sub> )**

它被称为**链式法则**，适用于任何一组随机变量。

*   通过比较可以看出，联合分布规范等价于一般概率断言，即 **P(X <sub>i</sub> |X <sub>i-1</sub> ……。，X<sub>1</sub>)= P(X<sub>I</sub>|父母(X<sub>I</sub>)**

鉴于此，**父母(X <sub>我</sub> )** **？** **(X <sub>i-1</sub> ……..x<sub>1</sub>)**T12】

*   因此，很明显，只有当每个节点有条件地独立于它的其他前辈时，贝叶斯网络才是域的正确表示。

**因此，使用的方法是:**

*   **节点:**最初的任务是确定领域建模所需的变量集。现在，把它们排列成**{ X****<sub>1</sub>****…..x**T10<sub>n</sub>T13**}**。

**注意:**顺序可以任意。但是如果它总是按照正确的顺序，结果会更有效和紧凑。

*   **链接:**申请循环为:

对于 i=1 至 n do:

从 X <sub>1</sub> ……中选择。X <sub>i-1</sub> 是 X <sub>i</sub> 的最小父集合。

对于每个父代，包括从父代到 X <sub>i</sub> 的链接。

写下条件概率表，P(X<sub>I</sub>|父母(X <sub>i</sub> ))

所以，节点 X <sub>i</sub> 的父节点必须拥有 X <sub>1</sub> ……X <sub>i-1</sub> 中的所有节点，这直接影响 X <sub>i</sub> 。比如 P(AakashCalls|AkshatCalls，报警，地震，入室盗窃)= P(AakashCalls |报警)。

因此，该警报将是 AakashCalls 的唯一父节点。这是因为每个节点都与前一个节点相连，形成一个非循环网络。

**注意:**它告诉贝叶斯网络的一个性质，它不包含任何冗余的概率值。因此，不会出现不一致。

**条件独立语句**

为了创建条件独立语句，使用了拓扑语义。这些拓扑语义具有以下性质:

*   这些语义指定了图结构中的条件独立性关系。此外，这有助于导出数字语义。
*   拓扑语义规定，每个变量都应该有条件地独立于它的非后代，在非后代中给出了父变量。
*   一个节点有条件地独立于网络中的所有其它节点。其父母、子女、子女父母皆知。这个毯子被称为**马尔科夫毯子**。

**下图显示了一个马尔可夫链的例子:**

<figure class="aligncenter">![Below figure shows an example of a Markov blanket](../Images/477691facbb89875515f03b898921112.png)</figure>

在上图中，显示了节点 X 有条件地独立于马尔可夫毯网络中的所有其他节点。

为了有效地表示条件分布，我们使用另一种形式的分布，称为**规范分布**。这种分布用于处理最坏的情况，即父母和孩子之间的关系完全是任意的。这里，完整的表可以通过用很少的参数命名模式来指定。******