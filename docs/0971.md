# Java 中的 JIT

> 原文:[https://www.tutorialandexample.com/jit-in-java](https://www.tutorialandexample.com/jit-in-java)

## 什么是 JIT？

JIT 代表“实时编译器”。它被称为“及时”，因为它是在解释将要发生的最后时刻被调用的。因此，在解释器之前，JIT 编译器快速分析代码并删除冗余，以便解释可以更快地进行。这是开发人员最困惑的话题之一。JIT 是 JVM ( Java 虚拟机)的一部分。JIT 的实际目的是在运行时将字节码编译成机器码。在这个转换过程中，JIT 对代码进行了一些优化，这样代码就可以非常快地执行，同时也提高了执行的性能。在运行时，如果程序包含一条可以多次执行的指令。当时，JVM ( Java 虚拟机)用于读取指令，并将该指令转换为机器代码，并在 CPU 上执行该指令。这里，术语“编译器”指的是从 Java 虚拟机(JVM)的指令集到特定 CPU 的指令集的翻译器。

## 在做 JIT ( Just in time)编译器？

来理解 JIT 是如何工作的？首先，让我们了解如何编译和运行一个简单的 java 程序。

Abc.java

```
class Abc{
public static void main(String args[]){
System.out.println(" Hi ! I am abc ");
}
} 
```

**输出:**

![JIT in Java](../Images/a3e0547fa87d4b03a552ad2337b6d8b9.png)  

**编译 Java 程序的语法:**

```
javac filename.java
```

**运行 Java 程序的语法:**

```
java filename
```

<figure class="wp-block-image">![JIT in Java](../Images/9be770d883cf9a9832bc9ed251384a54.png)</figure>

上图描述了 Java 程序的完整执行过程。与 c++相比，Java 程序的执行是完全不同的。因为 Java 程序既被编译又被解释。编译器和解释器参与整个执行过程。

从小矩形盒子开始。在第一步，也就是第一个框中，我们有 Java 代码，我们在这里输入 Java 代码并将 Java 文件保存为 filename.java，这里我以 abc.java 为例，这是第一步。下一步是使用“javac”命令调用 java 编译器。

当我们在 cmd(命令提示符)中键入 javac 时，编译器被执行或调用。现在编译器将编译整个 java 文件，并将其转换为带扩展名的字节码”。class”也就是图中的 filename.class，它被编译成 abc.class。所以，当我们编译时，我们会得到一个用犹太语写的类文件，我们无法理解或阅读。第二步，编译器检查语法错误和我们代码中的不同错误。

如果没有错误，那么它将生成字节码或者返回到第一步。这个阶段被称为字节码阶段。这前三个阶段(java 程序、编译器、字节码)是编译时阶段或编译阶段。

当我们调用 java 程序运行字节码时，也就是当我们在 cmd 中给出“Java 文件名”时。这一步被认为是第四步。现在这个字节码，即 abc.class 由“类加载器”加载。“类加载器”也是 JVM ( Java 虚拟机)内部的一个程序。它在 JVM 中加载字节码。然后 JVM 内部又多了一个程序“字节码验证器”。“字节码检验器”检查字节码中的任何错误或缺陷。所以这些都发生在 JVM 内部。在这个“解释器”被调用之后。

解释器和编译器的基本区别是什么？

编译器编译整个文件。例如，如果文件包含十行。然后，只有在程序中没有错误的情况下，编译器才会将所有行转换成字节码或类文件。而解释器一行一行地解释。现在考虑同一个例子，对于一个文件的十行，解释器首先获取第一行，并将其转换成类文件或字节代码。然后对第二个文件进行同样的操作。

因此，在“字节码验证器”验证了类文件之后，它会根据某些条件将文件发送给“解释器”或“JIT”。解释器逐行解释代码，并将其发送到 JVM 之外，即发送到 OS(操作系统)或任何硬件，然后执行。

步骤 1: Java 代码(filename.java)

步骤 2:整个 java 文件被转换成带有扩展名的类文件。通过在 cmd 中调用 javac。

步骤 3:检查任何错误，并将其转换成字节码。

第四步:字节码由“类加载器”加载。

步骤 5:字节码检验器检查类文件中的任何错误或缺陷。

步骤 6:取决于 JIT 类型。JIT 编译器或解释器被调用。

步骤 7:发送到操作系统获取输出。

为了理解 JIT 编译器，我们应该看两种情况。

**案例 1:**

让我们假设在这种情况下我们没有使用 JIT 编译器。

![JIT in Java](../Images/863a6d5a8b8f16c0b663780498719da5.png)  

这里我们有五行代码，这个代码已经是一个类代码了。目前，我们处于第六阶段。现在这个字节码被发送给解释器。解释器逐行解释类代码，并生成相应的输出，并将它们传送给 CPU 执行。

由于这只是一个五行代码，我们将在几分之一秒内得到我们需要的输出。如果我们的程序包含数千行代码。然后解释器逐行执行，所以产生输出需要一些时间。案例 1 中需要注意的要点是最后两行是相同的。即使它们是相同的，解释器也会将它们视为不同的行，并给出相同的输出。这是不必要的，我们可以保存一个指令。

案例二:

![JIT in Java](../Images/1854449b400700127eb3b6cccbd2f420.png)  

在案例 2 中，我们涉及了 JIT 编译器。字节码首先进入 JIT 编译器。JIT 编译器分析整个代码(因为它是一个编译器，所以它分析整个代码)，并查看是否可以排除任何冗余行。她的最后一行是额外的，如果它被删除，输出也不会改变。因此，它会排除最后一行，并将前四行转移给解释器。现在，解释器假定字节码只有四行，并只解释四行。而输出也将只有前四行。

我们注意到有一行被保留了。这就是 JIT 编译器发挥作用的地方。调用 JIT 编译器取决于所使用的 JIT 编译器的类型。有些 JIT 编译器非常激进，每次都会被调用，有些则不然。根据 JIT 编译器的编码和内置特性，它被调用。但是根据巨大的规模，JIT 编译器可以非常有效，它可以优化代码，使处理和执行非常快。