# Java 中的进程和线程

> 原文:[https://www . tutorialandexample . com/process-and-thread-in-Java/](https://www.tutorialandexample.com/process-and-thread-in-java/)

### 过程

它是一个运行在你电脑上的程序。该进程是一个重量级进程，它与其他进程分开占用内存。这个过程可能是一个小的后台任务，如拼写检查；它可能是 internet explorer 或 Microsoft word。所有进程都有一个或多个线程。该过程对一组数据执行一系列操作。

这些进程由操作系统创建、调度和终止，供 CPU 使用。在 PCB(过程控制块)的帮助下控制过程的操作。PCB 可以被认为是进程的大脑，拥有进程的所有关键信息，如进程 id、优先级、状态、内容、CPU 寄存器和 PWS。

PCB 被认为是基于内核的数据结构，它提供了调度、分发和上下文保存三种功能。

**调度**:它选择(决定)在 CPU 中先执行(运行)哪个进程。

**调度:**为流程的执行设置一个环境。

**Context save:** 当进程恢复或被阻塞时，它保存关于进程的信息。

<figure class="wp-block-image">![Process and Thread in Java](../Images/c66fca7bcee4d5e809b206c9952c0d82.png)</figure>

进程是一个正在执行的程序。操作系统必须分配资源；每个进程都使用这些资源，并在进程终止时释放这些资源。这些增加了操作系统向进程提供所有这些资源的责任。反过来，操作系统有管理这些进程和调度进程的负担。如果系统中创建了许多进程，操作系统将无法将这些资源分配给任何进程，反过来，系统将被挂起。为了解决这个问题，实现了线程的概念。

流程生命周期包含某些状态，如就绪、运行、阻塞和终止。为了构成某一瞬间处理活动的轨迹，使用了它的状态。

进程提供了实现程序并发执行的媒介。子流程由并发程序的主流程创建。主进程和子进程需要相互交互来完成共同的任务。

### 过程特征

1.  该进程有进程 id、CPU 寄存器、内存位置、堆栈。
2.  该进程有自己的虚拟地址空间。
3.  它提供了对处理器、其他进程、文件和 I/O 的受保护访问。
4.  过程是重量级的。
5.  进程的创建包括对每个进程单独的系统调用。
6.  单个进程不共享数据和信息，而是占用其独立的内存空间。
7.  进程使用 IPC(进程间通信)机制进行通信，这大大增加了系统调用的数量。
8.  流程管理消耗了更多的系统调用。
9.  每个进程都包含堆栈和堆内存、指令、数据和内存映射。

### 线

线程是一个轻量级进程，它共享单个进程的内存。它支持多线程。每个线程只与一个进程相关，任何线程都不能存在于进程之外。线程代表了一种提高操作系统性能的软件方法。它们还规定了在共享内存多处理器上并行执行应用程序的合适机制。线程不是相互独立的；这就是为什么它们彼此共享代码段、数据段和操作系统资源(比如打开的文件和信号)。但是线程有自己的程序计数器(PC)、寄存器集和堆栈空间，就像进程一样。内核为每个线程提供了一个堆栈和一个线程控制块(TCB)。线程主要有称为运行、就绪和阻塞状态的状态；它只包括计算状态，不包括资源分配和通信状态，减少了切换开销。它增强了并发性(并行性),因为许多线程是单个进程的一部分。所以，每个线程被分配去做任务以加速完成任务。

当多个线程处于活动状态时，JVM 为每个线程提供默认的优先级。线程的优先级指定了相对于同一进程中其他活动线程的执行时间。

### 螺纹特征:

1.  由于单个进程正在为单个任务执行，线程可以是进程的一部分，并且它可以执行进程的一部分；因此，它成为轻量级的过程。因此，单个进程可能有许多这样的线程，它们将负责整个进程执行的一部分。所以，每一个在进程中创建或生成的线程也有其特点。
2.  线程包括线程 id、程序计数器、寄存器组和堆栈，因为进程具有进程 id、CPU 寄存器和内存位置。每个线程都有不同的线程 id。
3.  线程共享进程的资源，并且正在执行进程的某个部分
4.  带线程的进程分为以下几类:进程可以是单线程的，也可以是多线程的。
5.  仅通过一个系统调用就创建了多个线程(轻量级进程)。
6.  线程管理不考虑或很少考虑系统调用，因为线程之间的通信可以使用共享内存来实现。

7.进程的隔离属性增加了资源消耗方面的开销。

### 单线程的

单线程指的是从头到尾执行一个完整的进程，不被单线程中断。这里，每个进程都与寄存器、堆栈、代码、数据、文件相关联，由单个线程使用。该进程包含一个线程，该线程一次只为一个进程执行一项工作。

<figure class="wp-block-image">![Process and Thread in Java2](../Images/38d72b5ad2d4eb473030b13ba0d3e62c.png)</figure>

例如:如果一个 web 服务器是一个单线程进程，那么 web 服务器一次只会处理一个请求，而所有其他用户都必须等待这个请求完成。

### 多线程

多线程指的是允许在一个进程中有多个线程，以便它们在共享资源的同时独立执行。

这里，每个线程都有自己的寄存器和堆栈，用于存储信息或存储这些特定线程在这些寄存器和堆栈中完成的工作。

<figure class="wp-block-image">![Process and Thread in Java3](../Images/87c0f896cedb5aaa04299d95e93689ef.png)</figure>

由于这是多线程进程，线程在分配给进程的相同资源中执行；因此，多线程进程或线程被称为轻量级进程，因为它不需要额外的资源来执行。

**例如:**

1.  在多线程 web 服务器中，每个线程将被分配给每个用户，每个用户将能够从 web 服务器访问所需的信息。
2.  类似地，字处理器将有一个线程来同时访问来自用户的数据。另一个线程将执行以找出错误，拼写错误将由用户键入，而其他线程参与文件的加载，这是字处理器所需要的。

### 多线程相对于单线程的优势:

<figure class="wp-block-image">![Process and Thread in Java4](../Images/870990bce3c55ec06e1a0011bee7cfea.png)</figure>

### 响应性

通过使用多线程，即使程序的一部分被阻塞，它也允许程序运行。如果进程正在执行一个冗长的操作，程序也会继续运行。

由于许多线程同时为任何单个进程执行，这增加了进程的响应性，因为许多线程做相同的工作将提高进程的响应。在交互式应用中，我们允许程序继续运行，即使一部分被阻塞或者正在执行一些冗长的操作；尽管如此，应用程序还是会因为多线程而做出响应。

### 资源共享

单个应用程序可以在同一个地址空间中拥有多个线程，以共享分配给该进程的资源。

由于线程是同一个进程的组成部分，它们共享它们所属进程的内存和资源。线程属于正在执行一些指令的特定进程，因此这些允许应用程序的代码共享的好处，因此不同的线程可以在相同的地址空间中执行应用程序的各种活动。

### 经济

与线程相比，创建进程需要更多的内存和资源，因此成本更高、更耗时。管理和创建远高于线程创建和管理。

每个线程都在它所属的进程中执行。线程不必分配新的内存空间或资源，因此它们降低了操作系统的资源利用率。由于每个线程都是同一进程的一部分并执行该进程的特定部分，因此不再需要在进程之间进行上下文切换，因此减少了进程的上下文切换，这进而减少了任何操作系统的资源需求。因此，它消除了创建和维护进程而不是线程的开销。

### 多处理器架构的利用

在这种架构中，每个线程都可以使用多线程在不同的处理器上并行运行。这增加了系统的并发性。相反，在单处理器系统中，一次只能有一个进程或线程在一个处理器上运行。

我们可以利用多处理器架构的全部能力，其中每个线程都可以分配给一个处理器来完成某项任务。多处理器系统中的多个处理器将执行可能是大处理器的一部分的单个作业，因此这通过在不同的处理器上运行并行指令来大大提高执行速度或执行进程的速度。

即使有许多处理器可供执行，单线程进程也只能在一个处理器上运行。相比之下，多线程进程将利用系统中所有可用的处理器。

### 进程和线程的区别是什么？

| 过程 | 线 |
| 该过程是资源密集型或重量级的。 | 线程比进程占用更少的资源，并且是轻量级的。 |
| 进程切换需要与操作系统交互。 | 线程的切换不需要与操作系统交互。 |
| 所有进程都有相同的代码，但是在多个处理环境中有自己的私有内存和文件资源。 | 所有线程共享相同的资源集和进程的打开文件。 |
| 在第一个流程解除阻塞之前，没有其他流程可以执行。 | 如果一个线程被阻塞并等待，同一任务中的另一个线程可以运行。 |
| 不使用线程，进程使用更多的资源。 | 多线程进程使用更少的资源。 |
| 每个过程都独立于其他过程运行。 | 线程之间不是独立的，因为一个线程可以读取、写入或更改另一个线程的数据。 |

### 线程与流程有何不同？

### 更快的上下文切换

当计算机的 CPU 从一个进程或线程切换(移动)到另一个进程或线程时，就会发生上下文切换。上下文切换允许 CPU 处理多个进程或线程，而不需要额外的处理器。(计算机的 CPU)处理器跟随从一个任务转换(切换)到另一个任务，同时确保任务不冲突。

上下文切换包括存储进程或线程的状态或上下文，以便在需要时可以重新加载，并且可以从同一点继续执行。这是操作系统的多任务特性，允许多个进程共享一个处理器。

与进程上下文切换相比，线程之间的上下文切换时间更短，因为与进程相比，线程与共享内存相关。与线程上下文切换相比，进程上下文切换包含更多的 CPU 开销。

### 沟通

多线程之间的通信很容易，因为它们共享公共地址空间(共享内存)。同时在这个过程中，我们必须遵循一些特定的通信技术(即，更多的系统调用等。)用于进程间的通信，因为它们不共享内存空间。

### 提高了系统的吞吐量

在多线程机制中，每个线程都有一个被认为是一个作业的功能，那么单位时间内完成的作业数量就增加了，从而增加了系统的吞吐量。

### 资源共享

在一个进程中的所有线程之间，共享代码、数据和文件等资源。但是该进程不共享任何东西。

### 多处理器系统的有效利用

如果一个进程有多个线程，那么我们可以在多个处理器上调度这些线程。这种机制将导致流程执行更快。但是分配给处理器的完整进程需要时间来根据其活动完成情况来完成。线程当然提高了进程内部的效率，但是不同的进程完成后都依赖于它的活动来终止。

### Java 中的多任务

多任务是一种机制，在这种机制中，用户一次执行一个以上的计算机任务。操作系统可以跟踪你在这些任务中的位置，并且在不丢失信息的情况下从一个任务转到另一个任务。这是一种同时执行多项任务的方式。参与多任务处理的操作系统有微软的 Windows 2000、IBM 的 OS/390 和 Linux。

现实生活中的例子——课堂学生是执行多任务的最佳方式。

1.  学生在听课。
2.  他们正在记录要点。
3.  他们正在班里被很多同学查手机。
4.  他们正在观察老师的教学方法。

### 多任务类型

1.基于流程的多任务处理

2.基于线程的多任务处理。

**基于进程的多任务**:同时执行多个任务，其中每个任务都是一个单独的独立程序(进程)，就是基于进程的多任务。

示例–所有这三项活动将同时执行，并且每项任务相互独立。

1.  在编辑器中键入 java 程序
2.  听同一个系统的歌。
3.  从互联网下载文件。

当我们在编辑器中输入 java 程序时，我们可以在从网上下载文件的同时听同一系统的音频歌曲。所有这些任务将同时独立执行，因此它是基于进程的多任务处理。对于操作系统层面更好。

### 基于线程的多任务处理:

它是同时执行几个任务的过程，其中每个任务都是同一程序的独立部分。这种类型的多任务被称为基于线程的多任务，每个独立的部分被称为线程。它适合编程级别

举例:一个程序中，有 10000 行字。前 5000 行代码独立于其他 5000 行代码，这意味着第一行与第一个客户相关，第二行与另一个客户相关，因此无需在第一行代码后等待执行第二个客户代码行。同一个程序的两个部分可以同时运行，因此完成执行所需的时间几乎不会减少。第一独立部分和第二独立部分同时执行单独的任务，其中每个部分是同一程序的单独独立部分，并且每个独立任务是线程。这种类型的多任务处理是多线程。

### 基于进程的多任务和基于线程的多任务有什么区别？

| **基于流程的多任务处理** | **基于线程的多任务处理** |
| 上下文切换是有成本的 | 上下文切换不会增加成本 |
| 每个进程都有一个独立的地址空间。 | 每个线程共享一个地址空间。 |
| 每个任务都是一个独立的过程。 | 每个任务都是同一个程序中独立的部分。 |